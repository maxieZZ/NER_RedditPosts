# Using Tools in Natural Language Processing to Analyze the Motivations, Attitudes, and Perceptions of Prescription Stimulant Users on Reddit

## Summary

As the only major controlled drug with increasing prescription rates in 2023, the rising popularity of stimulants like Adderall continues to spark debate over appropriate uses and long-term effects in adults (Jetson, 2023). To understand the impact of rising stimulant prescriptions from the perspective of users, I choose to extract and analyze posts from the subreddit r/adderall, a Reddit page dedicated to the discussion of ADHD drugs for recreational and medical use. Specifically, 6,417 relevant posts along with 13 associated features (including the overall sentiment of each post and user-derived tags) were collected from the subreddit to better understand user perspectives on medical and non-medical uses of stimulants and their perceived effects. In conducting exploratory and descriptive analysis on post features, general topics of discussion such as Medications, Questions, Co-Use, Harm Reduction, Healthcare, and Personal Experiences were identified. Relationships between features were also interrogated, with one example being an increase in negative relative to positive post sentiment during recent years. Using a topic modeling technique that leveraged embedding models and c-TF-IDF known as BERTopic, 61 additional topics were extracted from the text. These topics were more specific and contained information on physical side effects, psychological side effects, harm reduction strategies, stimulant alternatives, and personal stories detailing experiences such as barriers in accessibility or using stimulants to enhance productivity. The extracted BERTopic categories, user-derived Flair tags, and post sentiment findings were complimentary and aligned well with related literature. This approach helped to identify unmet needs surrounding prescription stimulant use, including the desire for information on ways to holistically manage ADHD symptoms rather than relying solely on pharmacological treatments like Adderall. With this NLP-based approach, we can begin to disambiguate controversies in current adult ADHD research, diagnosis, and clinical care to guide safe and appropriate prescribing practices.

## Learning Objectives

* Use Natural Language Processing (NLP) to extract and filter data from online social media forums like Reddit.
* Understand and conduct a Descriptive and Exploratory analysis of all relevant features in the Data Needs Model (DNM).
* Use BERTopic, a topic modeling technique that leverages BERT embeddings and c-TF-IDF, to extract relevant topics from the textual data of posting activity on Reddit.
* Translate results from Exploratory, Descriptive, and Topic Modeling analyses to applicable and actionable insights related to prescription stimulant use.
* Develop coding skills in Python, working specifically with toolkits like pandas, genism, nltk, and the BERTopic modeling package. 

## Proposed Outcomes

* Automated pipeline to extract a maximum number of posts from a given subreddit.
* Data Needs Model (DNM) using the available Reddit data with features that align with the investigative aim.
* Visuals for exploratory and descriptive analysis that capture relevant insights derived from the DNM and any associated relationships between features. 
* Pipelines to preprocess and tokenize text for BERTopic topic modeling analysis.

<details>

<summary>INTRODUCTION</summary>

With the capacity to stimulate the central nervous system and cause excitation, elevated mood, and increased alertness, prescription stimulant use is expanding. While prescription stimulants can be used to enhance cognitive performance, suppress appetite for weight loss, or alleviate conditions like Attention Deficit Hyperactivity Disorder (ADHD) and narcolepsy, they also have the potential for non-medical use and abuse (Favrod-Coune, 2010). The rise of prescription stimulants for non-medical use is particularly apparent in college settings, where 61.7% report diverting their stimulant prescriptions and 36% believe stimulants like Adderall, are “not harmful” and can “make them smarter” (DeSantis, 2010). Though these accounts along with rising prescription rates have raised some alarm in the wake of a devastating opioid crisis, a protracted controversy surrounding the use and impact of these stimulants remains. On the other side of this debate, studies point to the high efficacy of stimulants when prescribed properly and interpret the rise in prescription rates as correcting for the underdiagnosis of conditions like ADHD (Abdelnour, 2022). Regardless of which interpretation is accurate, it is clear that prescription stimulant use is on the rise, increasing by 70% between 2011 and 2021 (Kim, 2023). 
	To better understand the impact of this rise, information from medical and non-medical users of stimulants is essential. However, since many are reluctant to divulge accounts of non-medical stimulant use due to stigma and legality issues, this kind of data is increasingly difficult to obtain. With surveys reporting the number of non-medical stimulant users on college campuses to be anywhere from 5% to 35%, alternative data sources are needed to help narrow this wide interval (Robitaille, 2018). As a quasi-anonymous and supportive space for users to divulge personal struggles or socially stigmatized experiences, social media sites like Reddit provide one possible solution to this data problem. With a 44% growth since 2020, Reddit has over 52 million daily active users, making it the 9th most popular social media app in the US with over 25% of US adults using the site (Dean, 2023). Reddit’s popularity is due in part to its subreddit structure which allows users to create separate groups known as subreddits based on shared interest or experience. The subreddit “r/adderall” was created on April 3, 2010, and is described as “a subreddit dedicated to discussing ADHD drugs for both recreational and medical uses” (Reddit Metrics, 2018). The explicit reference to both “recreational and medical use” combined with encouragement to post authentic and personally relevant experiences with stimulants provides a rich setting for the collection of insightful data. Furthermore, r/adderall has experienced a huge surge in membership since its creation which parallels the growing rate of stimulant use, rising from 14,960 in 2015 to 115,953 in 2023 (Robitaille, 2018). The personal and largely candid perspectives that posts from this subreddit provide make it an ideal source of information from which to investigate the different perspectives of stimulant users as well as their overall attitude and perception of effects. 
	With the rise of Natural Language Processing (NLP) tools, it is also becoming increasingly possible to extract themes, patterns, and sentiment from large corpora of text in relatively short periods of time. While transformer embeddings and clustering algorithms allow for the unsupervised extraction of relevant topics from unstructured text, tools like Valence Aware Dictionary and sEntiment Reasoner (VADAR) and Linguistic Inquiry and Word Count (LIWC) provide insight into the sentiment associated with each phrase or overall topic. Using NLP tools to uncover major themes, patterns, and sentiments from user activity in the r/adderall subreddit, firsthand perspectives on stimulant use and effects can be extracted to reveal novel insights. In identifying themes and associated sentiments surrounding medical and non-medical use of prescription stimulants, a more comprehensive picture of stimulant use can be created to inform next steps and identify areas requiring further investigation.

### History of Prescription Stimulants & Uses

When looking at the most common medical use cases for prescription stimulants, a study done by the Washington State Department of Health found that nearly 90% of all FDA-approved prescriptions (dispensed from 2012-2022) were used for ADHD treatment. Other medical uses, which together made up around 10% of cases, included sleep-wake disorders like narcolepsy and weight loss (Jetson, 2023). To understand how prescription stimulants became so commonly linked with ADHD, I conducted a brief literature search on reviews examining the history of prescription stimulants in conjunction with ADHD. In the early 1900s, most people did not accept ADHD as an actual disorder, claiming instead that it was an “abnormal defect” of moral control that described “high-grade feeble-minded” children (Martinez-Badia, 2015). However, in 1937, Charles Bradley accidentally discovered the potential use of Benzedrine (one of the first synthesized amphetamine stimulants) upon noticing that, rather than helping with this initial goal to alleviate headaches, it helped children instead with behavior and school performance (Bradley, 1937). Although ADHD was not recognized yet as a disorder (known then as “hyperkinetic impulsivity”), this finding set off the first wave of interest in stimulants, beginning with Adderall’s synthesis in 1960 and continuing with the discovery of Ritalin (the first methylphenidate stimulant) for “emotionally disturbed children” in 1963 (Conners, 1963). In response to the rising popularity of stimulants and their efficacy in alleviating ADHD symptoms, the Diagnostic and Statistical Manual (DSM) partially recognized ADHD for the first time as “disorders of hyperkinetic reaction of childhood or adolescence and organic brain syndrome” (2nd ed.; DSM–II; American Psychiatric Association, 1968). This acknowledgment would spark some of the first controversy around stimulants for the treatment of ADHD, with reports of heavily medicated school children invoking a worried skepticism that culminated in the Comprehensive Drug Abuse Prevention and Control Act of 1971, making stimulants like Ritalin and Adderall Schedule II drugs (Gabay, 2013). As the battle between skeptics and advocates continued, treatment for ADHD has become more and more widespread, although an updated American Academy of Pediatrics (AAP) cautioned that prescription stimulants should be combined “with appropriate management of a child’s environment and curriculum” (Colson, 1997). Since then, several popular prescription stimulants have risen in popularity and are described in more detail in Table 1. 

<img src="images/table1.png?raw=true"/>

While many other medications contain the same active ingredients as those listed in Table 1, this investigation will focus on the four most popular prescription stimulant medications, including Adderall XR, Adderall IR, Vyvanse, and Ritalin. 

### Attention Deficit Hyperactivity Disorder (ADHD)

With ADHD as the driving force behind most stimulant prescriptions, it’s important to understand its prevalence and history within the general population. As a common neurodevelopmental disorder, ADHD occurs in approximately 5-7.2% of children and 2.5-6.7% of adults, serving as a possible precursor to psychiatric conditions like depression anxiety or addiction as well as conditions like obesity (Sibley, 2023; Abdelnour, 2022). Like the rise in stimulant prescriptions, the prevalence of ADHD diagnoses has grown, rising from 6.1% to 10.2% from 1997 to 2016 according to national population surveys (Abdelnour, 2022). While some worry that ADHD is over-diagnosed and consequently over-prescribed, studies have shown that those who struggle with ADHD are helped immensely by prescription stimulants which are effective in up to 70% of cases (Jensen, 2007).

### Research on Adult ADHD

It’s also important to note ADHD’s gradual transition from a childhood and adolescent disorder to a lifelong condition which requires a separate set of treatment protocols given that adult care is very different from pediatric care. Unfortunately, knowledge about and support for research on adult ADHD is lagging with just under 5.5 million in active funding compared to the 42 million in funding for pediatric ADHD. Compared to depression which has only a slightly higher population prevalence than ADHD, research funds for depression are greater by nearly 10-fold (Sibley, 2023). Together, these findings suggest that adult ADHD requires additional research and funding to inform treatment using both pharmacological and non-pharmacological approaches. The growing recognition of ADHD in adults in conjunction with prescription increases raise questions about current adult ADHD research, diagnosis, and clinical care. The development of clinical recommendations for clinicians to better diagnose and treat adults with ADHD as well as guidelines for patients to manage ADHD symptoms will be critical in guiding safe and appropriate prescribing. 

### Non-Medical Uses of Prescription Stimulants

While cases of non-medical prescription stimulant use had prompted some research in the past, a 2016 paper covered by various popular news agencies played a major role in bringing these concerns to light and inspiring additional research. In this paper, emergency room data from 2006-2011 suggested that emergency department visits related to prescription stimulant use in adults increased markedly despite prescription trends remaining the same. Specifically, non-medical use increased by 67% and associated ED visits went up by 156% in adults. Furthermore, the primary source of these stimulants seemed to be coming from friends or relatives, suggesting that prescribed stimulants were often diverted (Chen, 2016). Indeed, many college-age students report diverting prescribed medications, with around half diverting their prescriptions according to one study (Kinnman, 2017). When examining the motivations for these diversions, studies suggest that students tend to overestimate the cognitive benefits of stimulants while underestimating or discounting risks, believing that prescription stimulants are much safer than illicit drugs (Kinnman, 2017; DeSantis, 2010; Lueck, 2020). College students often report using prescription stimulants to help meet specific academic standards and demands, believing stimulants increase concentration and alertness, and also help with studying (Lueck, 2020). There are a few papers that attempted to measure the impact of stimulants on cognitive function and problem-solving capabilities of medically prescribed and non-prescribed participants. In one randomized double-blinded trial conducted on non-prescribed users, researchers found that prescription stimulants increased motivation to perform a given task but often decreased the quality of effort when executing the task (Bowman, 2023). The underestimation of risk combined with conflicting points on the benefits of Adderall for focus motivates the need for a better understanding of user perspective and experience to inform appropriate care.

### Reported Side-Effects of Prescription Stimulants

Compared to cocaine or methamphetamine, the kinetics of amphetamine stimulants are less rewarding because they have a slower rate of reuptake in the brain (Heal, 2013). However, long-term use of stimulants, even when prescribed by a doctor, can lead to tolerance which requires higher or more frequent doses and increases the potential for substance abuse. If addiction to prescription stimulants occurs, a person may be vulnerable to symptoms like fatigue, depression, and sleep problems in the case of withdrawal (National Institute on Drug Abuse, 2018). In 2007, warning labels on prescription stimulant medications for ADHD were also updated to include risks for adverse cardiovascular events and psychiatric symptoms like delusional thinking or mania (U.S Food and Drug Administration, 2011). Indeed, a fair number of articles have reported adverse cardiovascular events, particularly in adults (Lewares, 2023; Tadrous, 2021; Sichilima, 2009; Torres-Acosta, 2020). Adderall XR was even withdrawn from the Canadian market in February of 2005 due to concerns of possible cardiotoxicity and cerebral vascular events in a small number of individuals who had taken the medication (Cheng, 2007). After appealing the decision, the committee concluded it was “biologically plausible” that stimulants increased the risk of adverse cardiovascular events, but methodologically weak analyses and inconclusive proof suggested that it should be reinstated on the market with a revised cautionary label (Kondro, 2005). While there are many side effects associated with these prescription stimulants, the most common include decreased appetite, trouble sleeping, and headaches (Fredriksen, 2014). Depression or anxiety can also result in cases of addiction along with psychosis, anger, paranoia, and gastrointestinal issues. Behavioral therapies can be effective not only in helping people stop abusing stimulants but also in managing ongoing prescription use and associated side effects (National Institute on Drug Abuse, 2018). 

### Recent Trends in Prescription Stimulant Use

Along with a brief history, medical and non-medical uses, and side effects of prescription stimulants, it's important to understand how documented prescription stimulant use has changed over time and whether specific demographic groups are affected. While it is difficult to find data to track the activity of non-medical stimulant users, the CDC analyzed MarketScan commercial claims to describe trends in prescription stimulant fills before and during the COVID-19 pandemic (2016-2021). In their report, the CDC noted that the percentage of enrollees with one or more prescription stimulant fills increased from 3.6% in 2016 to 4.1% in 2021. However, from 2020-2021, the percentage of females aged 15-44 and males aged 25-44 with prescription stimulant fills increased by more than 10% (Danielson, 2023). Since most of these prescriptions were matched with ADHD diagnosis codes, the CDC discussed a few different theories that could explain this phenomenon. The first explanation centered around the historical and incorrect definition of ADHD being a childhood disorder that was more common among boys. Now that ADHD is increasingly being recognized as a lifelong condition that might be underdiagnosed and undertreated in both girls and young adults, these changes may have contributed to the steady rise and spike in stimulant prescriptions during 2021. Another theory emphasizes the COVID-19 pandemic which may have exacerbated ADHD symptoms due to associated stress, depression, and/or anxiety. The increase in prescriptions and diagnoses could also be partially due to the expansion of telehealth services during the COVID-19 pandemic which were given a temporary allowance to prescribe virtually, making it much easier for people to obtain prescription stimulants (Prescribing controlled substances via telehealth, 2023).  In October of 2022, the U.S. Food and Drug Administration (FDA) formally announced a shortage of Adderall with very little explanation and a massive gap in available manufacturing reporting information (Weiss, 2023). This ongoing shortage combined with the 2021 surge in prescription rates and controversy over use cases motivates the need to understand user perspectives surrounding medical and non-medical uses and the impact of prescription stimulants. 

</details>

<details>

<summary>Methods</summary>

### Data Needs Model

Following a Data Quality (DQ) assessment framework proposed by Diaz et al. (2019), my aim to identify major themes and associated sentiments in the subreddit r/adderall was mapped to an analytical design. Specifically, all extractable measures available through the Reddit API were examined to determine whether they could be used to answer my research question. Based on this analysis, a Data Needs Model (DNM) was developed that incorporated features that were relevant to my investigative aim and defined an ideal dataset. While the process of constructing the DNM was iterative based on the quality and quantity of extracted data, it created a systematic process from which the data could be saved to an accessible tabular format. During the process of defining the DNM, the format was designed to be in 3rd normal form (Tidy Data) which meant that each variable was in one column only, each observation was in its separate row, and related variables could be linked together. The finalized version of the DNM was a single table with each row representing a given post and each column representing the extracted feature of a given post. The name of each feature along with its data type and description is given in Table 2 below.

<img src="images/table2.png?raw=true"/>

The final DNM design given above was produced only after many iterations and some of the included variables were added later after preprocessing. As one example, the “Sentiment” feature was created after data extraction/filtering by applying the VADER sentiment analysis tool in Python to the “Text” feature. The “Rising,” “Top,” “New,” “Controversial,” and “Hot” features on the other hand were all sorting categories required by the Python Reddit API Wrapper (PRAW) to extract posts from the r/adderall subreddit. Figure 1 given below shows the layout of these features on a webpage. 

<img src="images/figure1.png?raw=true"/>

On the right-hand side of Figure 1, a description of the subreddit is posted along with the name of the subreddit (r/adderall), the total number of members (~116,000), and the number of members currently online (66). On the left-hand side of the page, users can view posts and affiliated comments which can be sorted according to the five different sorting categories: top posts, new posts, rising posts, hot posts, and controversial posts. When a user clicks on a given post, they have the option to give the post an “upvote” (like) or a “downvote” (dislike). Posts with a higher ratio of upvotes to downvotes are more likely to become ‘top’, ‘hot’, or ‘rising’ posts while posts with a mixture of upvotes and downvotes are more likely to be labeled as ‘controversial.’ Posts can also be sorted according to the date posted using the ‘new’ filter. While each post has a ‘text’ attribute (a longer description that makes up the main content), Reddit provides an optional feature for posts to be tagged with an attribute known as a Flair. Similar to a hashtag, a flair is a category that the user creates to describe their post. Examples of flairs include Questions, Announcements, Healthcare, or a specific medication (eg Adderall, Ritalin, Vyvanse… etc.). 

Using PRAW, features were extracted from each post based on the DNM requirements and saved to a tabular format using pandas. Because Reddit sets a limit on the number of extractable posts, only the top 1000 posts from each of the five sorting categories (top, rising, hot, controversial, new) were saved. Since subreddits are also monitored by moderators who can remove offensive or unrelated posts, the number of posts extracted from each sorting category was less than 1000 and resulted in a total of 1,992 extracted posts once duplicates were filtered. To more posts for topic analysis, I discovered a keyword search function on the API which I used to extract an additional 5,260 posts by filtering for the maximum number of posts containing the top 1-200 most common dictionary words. In total, this search process resulted in 6,452 posts which were used for further descriptive, exploratory, and BERTopic analyses.
	After the data was successfully extracted, descriptive analysis was conducted on each feature to assess data quality, filter any unrelated posts, and iteratively improve the DNM design to inform next steps in topic modeling and sentiment analysis. Using the vaderSentiment SentimentIntensityAnalyzer tool in Python, the overall sentiment was calculated for each post text and added to the DNM as an additional feature (see Table 1). Exploratory analysis was also conducted to interrogate any pertinent relationships between features in the DNM. 
Before performing topic analysis, the text underwent preprocessing which consisted of four major steps: cleaning (to remove punctuation, newline characters, etc.), tokenization (breaking down sentences), removal of stop words, and lemmatization. Once preprocessing was completed, I used a topic modeling Python library known as BERTopic to identify topics from the preprocessed text of posts. Combining both transformer embeddings and clustering model algorithms, BERTopic finds a vector representation for each post (known as an embedding) and then uses UMAP dimensionality reduction to maintain the local and global structure of the data while also reducing dimensionality and clustering embeddings. After assigning each post in the set to a cluster, it then retrieves the topic representation using a class-based TF-IDF (c-TF-IDF) where it selects words with the highest c-TF-IDF score to represent that given topic. While many different tools can be used to perform topic analysis in unstructured textual data, BERTopic was selected because it had significantly more success at identifying semantically relevant topics in social media data than other methods like Latent Dirichlet Allocation (LDA). Its ability to increase the coherence among terms for the same topic while removing irrelevant terms and increase the topic representation by removing synonyms and variations of the same word allows it to perform well on the Reddit dataset. 
Using the default BERTopic model parameters (n_neighbors=15, n_components=5, min_dist=0, metric=’cosine’, random_state=100), a UMAP model and BERTopic model were initiated and run using the preprocessed text of each post. Once major groupings were identified, I compared these results to the themes identified through the ‘Topic’ and ‘Flair’ features and also to the findings gleaned from my review of the literature to ensure proper evaluation. I also read keywords and subsets of posts from each topic to better understand what distinguished a given topic and labeled topics accordingly.

</details>
